SET("client connection")

BEFORE(
  excom_server_t server;
  excom_thread_t thread;
  excom_server_init(&server);
)

TEST("binding server",
{
  uassert_empty(excom_server_bind(&server));
})

PREFIX(
  static void* thrd(void* server)
  {
    return excom_server_run(server);
  }
)

TEST("running",
{
  excom_thread_init(&thread, thrd, &server);
  uassert_equal(thread.status, EXCOM_THREAD_STATUS_RUNNING);
})

TEST("sends data to client",
{
  int sock;

  sock = socket(AF_INET, SOCK_STREAM, 0);
  uassert(sock > 0);

})
